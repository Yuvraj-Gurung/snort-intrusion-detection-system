# Snort - IDS/IPS (Intrusion Detection/Prevention System)


## 1. Introduction

Intrusion Detection Systems (IDS) are essential for monitoring and detecting potential security breaches in a network. Snort is a powerful, open-source network IDS that can perform real-time traffic analysis and packet logging.

## 2. Objectives

- To install and configure Snort IDS.
- To monitor network traffic and detect potential intrusions.
- To analyze and interpret Snort alerts.

## 3. Prerequisites

- Basic knowledge of networking concepts.
- Understanding of network protocols (TCP/IP, HTTP, DNS, etc.).
- Familiarity with Windows command line.

## 4. Tools and Software

- **Snort**: Open-source network intrusion detection system.
- **Virtual Machine**: For creating a safe environment to run Snort.

## 5. Setting Up the Environment

**Lab Setup**

1. Download Snort IDS from the [official website](https://www.snort.org/downloads)

<img src="images/image1.png"> <img src="images/image2.png">

2. Install Microsoft Visual C++ 2015-2022 Redistributable (x64).

<img src="images/image3.png"> <img src="images/image4.png">

3. Download and install the Npcap.

<img src="images/image5.png"> <img src="images/image6.png"> <img src="images/image7.png">  <img src="images/image8.png">

4. Install Snort.

<img src="images/image9.png"> <img src="images/image10.png"> <img src="images/image11.png"> <img src="images/image12.png"> <img src="images/image13.png"> <img src="images/image15.png">

## 6. Configuring Snort

**Step 1: ðŸ’» Set the network variables**

ipvar HOME_NET IP_ADDRESS

ipvar EXTERNAL_NET !$HOME_NET

<img src="images/image21.png">
 

**Step 2: ðŸ’» Specify the Path to the rules files**

var RULE_PATH c:\Snort\rules

var PREPROC_RULE_PATH c:\Snort\preproc_rules

var WHITE_LIST_PATH c:\Snort\rules

var BLACK_LIST_PATH c:\Snort\rules

<img src="images/image22.png">


**Step 3: ðŸ’» Configure default log directory for snort**

config logdir: c:\Snort\log

<img src="images/image23.png">


**Step 4: ðŸ’» Configure dynamic loaded libraries**

dynamicpreprocessor directory c:\Snort\lib\snort_dynamicpreprocessor

dynamicengine c:\Snort\lib\snort_dynamicengine\sf_engine.dll

<img src="images/image24.png">


**Step 5: ðŸ’» Configure the Reputation preprocessor**

whitelist $WHITE_LIST_PATH\whitelist.rules

blacklist $BLACK_LIST_PATH\blacklist.rules

<img src="images/image26.png">


**Step 6: ðŸ’» Customize the rule set as follows**

Example:

<img src="images/image27.png"> <img src="images/image28.png"> <img src="images/image29.png"> <img src="images/image30.png">


## 7. Validating the Snort Configuration

1. Open -> Command Prompt -> Run as administrator

<img src="images/image14.png">

2. Navigate to the Snort Installation directory.

cd \Snort\bin

3. Run the following command:

snort.exe -i 4 -c C:\Snort\etc\snort.conf -T

<img src="images/image31.png"> <img src="images/image32.png">

## 8. Writing Snort Rules

1. Navigate to the Snort Installation directory - > Select rules folder - > Edit the (local.rules) files in Notepad++.

<img src="images/image33.png">

LOCAL RULES

alert icmp any any -> $HOME_NET any (msg:"ICMP Ping Detected"; sid:1000001; rev:1;)

alert tcp any any -> $HOME_NET 22 (msg:"SSH Authentication Attempt"; sid:1000002; rev:1;)

alert tcp any any -> IP_Address Port (msg:"FTP Connection Attempt"; sid:1000003; rev:1;)

<img src="images/image34.png">

## 9. Running Snort in IDS Mode

1. **Start Snort**: Run Snort in IDS mode to monitor network traffic.

2. Run the following command:

snort.exe -i 4 -c C:\Snort\etc\snort.conf -A console

<img src="images/image35.png"> <img src="images/image36.png"> <img src="images/image37.png"> <img src="images/image38.png"> <img src="images/image39.png"> <img src="images/image40.png">

## 10. Analyzing Alerts

1. **View Alerts**: Snort will display alerts in the console if any suspicious activity is detected.
2. **Analyze Logs**: Review the log files generated by Snort for detailed information on the detected intrusions.

Command:

snort.exe -i 4 -c C:\Snort\etc\snort.conf -A console > C:\Snort\log\test_logs_001.txt

<img src="images/image41.png"> <img src="images/image42.png"> <img src="images/image43.png">

## 11. Conclusion

By completing this project, I have gained practical hands-on experience in setting up and using Snort IDS to detect network intrusions. Understanding how to configure and analyze Snort alerts is essential for identifying and mitigating potential security threats.
